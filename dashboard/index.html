<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexoVision Dashboard</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .container {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            max-width: 900px;
            width: 100%;
        }

        h1 {
            color: #111827;
            margin-bottom: 2rem;
            text-align: center;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .card {
            display: flex;
            flex-direction: column;
            padding: 1.5rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            text-decoration: none;
            color: inherit;
            transition: all 0.2s;
        }

        .card:hover {
            border-color: #3b82f6;
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.1);
            transform: translateY(-2px);
        }

        .card h2 {
            margin: 0 0 0.5rem 0;
            color: #1f2937;
            font-size: 1.25rem;
        }

        .card p {
            margin: 0;
            color: #6b7280;
            font-size: 0.875rem;
            flex-grow: 1;
            margin-bottom: 1rem;
        }

        .status {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .status.core {
            background: #3b82f6;
        }

        .status.rt {
            background: #10b981;
        }

        .status.dev {
            background: #f59e0b;
        }

        .status.web {
            background: #8b5cf6;
        }

        .status.mobile {
            background: #ec4899;
        }

        small {
            color: #9ca3af;
            font-weight: 500;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>NexoVision Ecosystem</h1>
        <div class="grid">
            <!-- 1. CMSRT -->
            <a href="http://localhost:3005" target="_blank" class="card" id="card-cms-rt">
                <h2><span class="status core" id="status-cms-rt"></span>CMS-RT Unified</h2>
                <p>Instancia completa (App + API + WebSockets) por puerto 3005. Utiliza Float.js para el shell y widgets
                    react-native-web.</p>
                <small id="label-cms-rt">Checking status...</small>
            </a>

            <!-- 2. WIDGET CATALOG WEB -->
            <a href="http://localhost:3008" target="_blank" class="card" id="card-widget-web">
                <h2><span class="status web" id="status-widget-web"></span>Widget Catalog Web</h2>
                <p>Versión web del catálogo de widgets (puerto 3008).</p>
                <small id="label-widget-web">Checking status...</small>
            </a>

            <!-- 3. WIDGET CATALOG NATIVE -->
            <a href="exp://localhost:8081" class="card" id="card-widget-native">
                <h2><span class="status mobile" id="status-widget-native"></span>Widget Catalog Native</h2>
                <p>Aplicación móvil Expo (puerto 8081). Requiere simulador o dispositivo físico.</p>
                <small id="label-widget-native">Checking status...</small>
            </a>

        </div>
    </div>

    <script>
        async function checkPort(port) {
            try {
                const res = await fetch(`http://localhost:${port}`, { mode: 'no-cors' });
                return true;
            } catch (e) {
                return false;
            }
        }

        async function updateStatus() {
            const services = [
                { id: 'cms-rt', port: 3005 },
                { id: 'widget-web', port: 3008 },
                { id: 'widget-native', port: 8081 }
            ];

            for (const service of services) {
                const isOnline = await checkPort(service.port);
                const card = document.getElementById(`card-${service.id}`);
                if (!card) continue;

                const status = document.getElementById(`status-${service.id}`);
                const label = document.getElementById(`label-${service.id}`);

                if (isOnline) {
                    status.style.background = '#10b981'; // Green
                    status.style.boxShadow = '0 0 8px #10b981';
                    label.textContent = 'Online';
                    label.style.color = '#10b981';
                    card.style.opacity = '1';
                    card.style.borderColor = '#10b981';
                } else {
                    status.style.background = '#ef4444'; // Red
                    status.style.boxShadow = 'none';
                    label.textContent = 'Offline';
                    label.style.color = '#ef4444';
                    card.style.opacity = '0.8';
                    card.style.borderColor = '#e5e7eb';
                }
            }
        }

        setInterval(updateStatus, 3000);
        updateStatus();
    </script>
</body>

</html>